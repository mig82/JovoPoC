# Install Jovo

## 1. Install Jovo

Get the Jovo CLI

    npm install -g jovo-cli

Working with  jovo-cli@3.2.1

## 2. Create a place for voice projects

Create a place in the Visualizer project structure for the voice app or apps.
Let's make that `./voice`.

```
mkdir voice
```

The idea is to end up with this:

```
voice
└── VoiceAppFoo
└── VoiceAppBar
```

## 3. Create a Jovo project

We could call this after the Visualizer project.
**Note:** If we're going to support more than one, we'll have to prompt for a name.

```
cd voice
jovo new JovoPoC
```

This resuls in the following project structure.

```
voice/
└── JovoPoC
    ├── LICENSE
    ├── README.md
    ├── img
    │   └── debugger.gif
    ├── models
    │   └── en-US.json
    ├── package-lock.json
    ├── package.json
    ├── project.js
    ├── src
    │   ├── app.js
    │   ├── config.js
    │   └── index.js
    └── test
        └── sample.test.js
```

## 4. Run the Jovo project locally for development.

```
cd JovoPoC
jovo run --port 3301
```

Add the `--watch` flag to automatically restart when changes to the app are made.

```
jovo run --port 3301 --watch
```

**Note:** Visualizer already uses the default port 3000, so the `--port` option is necessary.

## 5. Build the Jovo project

Generate the platform specific files for Alexa and Google Assistant.

```
jovo build
```

This generates the `db` and the `platforms` folders.

```
voice/
└── JovoPoC
    ...
	├── db
    │   └── db.json
	...
	├── platforms
    │   ├── alexaSkill
    │   └── googleAction
    ...
```

Jovo advises that the `/platforms` folder should not be versioned. So:

```
echo "/platforms" >> .gitignore
```

## 6. Deploy Alexa Skill

Install and configure the ASK (Alexa Skills Kit) CLI. This will allow the CLI access to the Alexa dev account.

```
npm install -g ask-cli
ask configure
```

**Note:** there's a `--profile` option to create a new profile. We could do something like:

```
ask configure --profile quantum
```

This creates a JSON configuration file with all the profiles at `~/.ask/cli_config`.

For systems without a browser, use:

```
ask configure --no-browser
```

Initialise ASK in the project. This will prompt for the Alexa skill id, the package location (Already generated by Jovo) and the Lambda code path —if we mean to create one. The command is interactive.

```
ask init
? Skill Id (leave empty to create one):  voice-banking
? Skill package path:  ./platforms/alexaSkill/skill-package
? Lambda code path for default region (leave empty to not deploy Lambda):
```

To automate answers for it use the `expect` command.

```
echo '#!/usr/bin/expect
spawn ask init
expect "? Skill Id (leave empty to create one):"
send "quantum-skill\r"
expect "? Skill package path:"
send "./platforms/alexaSkill/skill-package\r"
expect "? Lambda code path for default region (leave empty to not deploy Lambda):"
send "\r"' > ask_init.sh
chmod u+x ask_init.sh
./ask_init.sh
rm ./ask_init.sh

```

**Note:** Piping answers to `ask init` using `|` and `echo`  or `printf` —e.g.:
`printf 'quantum-skill\n./platforms/alexaSkill/skill-package\n\n' | ask init`— won't work.


Deploy using Jovo. The `-p` flag allows to choose a specific platform `-p, --platform=alexaSkill|googleAction|spokestack`

```
jovo deploy --platform=alexaSkill
```

This uploads the voice model to the Alexa Skills and enables the new skill for testing on the linked Amazon account.

Open the [Alexa Dev Console](https://developer.amazon.com/alexa/console/ask) to make sure that the skill is deployed.

To run against a device, again use the `run` command and Ask Alexa to open *"my test app"*.

**IMPORTANT:** Voice models are language-specific, so the Alexa device must be set to use one of the locales for which a voice model has been created.

```
jovo run --port 3301
```

## Deploy Google Google Action

TBD

## Reconfiguration

Jovo offers an option to create different configurations per environment by using a naming convention on the `config.js` file —e.g.:

* `config.js`: Default config of the project
* `config.qa.js`: Config overrides for the QA environment (e.g. DynamoDB)
* `config.prod.js`: Config overrides for the production environment (e.g. DynamoDB + Analytics)

Read more [here](https://www.jovo.tech/docs/config-js#staging)


## Questions

1. Where should we create the Jovo project within the Vis project? Would `/voice` be adequate? Placing it under `/forms` seems off. However, voice apps can leverage UI designs for scenarios where they're bundled inside a screen app —the way [Botsociety](https://botsociety.io) does it.

2. Though the Jovo CLI does not yet support automatic deployment to DialogFlow (Agent creation is still manual), Google has introduced support for doing this programmatically via a REST API. See https://cloud.google.com/dialogflow/es/docs/reference/rest/v2/projects.agent/restore. Should we leverage this as a plugin/extension of our own? Or do we wait for Jovo to introduce it?
